<!DOCTYPE html>
<html>
<head>
  <title>Exercise 2 </title>

  <style>
    body {
      font-family: Arial, sans-serif;
    }

    table {
      width: 600px;
      border-collapse: collapse;
      margin-top: 10px;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }

    button {
      padding: 5px 10px;
    }

    select {
      padding: 5px;
    }
  </style>
</head>

<body>

<h2> Shopping Cart</h2>

<label>Select Coupon:</label>
<select id="coupon" onchange="applyCoupon()">
  <option value="none">-- Select Coupon --</option>
  <option value="SAVE10">SAVE10 (10% OFF)</option>
  <option value="NONE">No Coupon</option>
</select>

<div id="cart"></div>

<h3 id="total"></h3>

<script>
  let products = [
    { name: "Laptop", price: 50000, quantity: 1, category: "electronics" },
    { name: "Book", price: 500, quantity: 2, category: "education" }
  ];

  let couponDiscount = 0;

  function renderCart() {
    let html = `
      <table>
        <tr>
          <th>Product</th>
          <th>Price</th>
          <th>Quantity</th>
          <th>Remove</th>
        </tr>
    `;

    products.forEach((item, index) => {
      html += `
        <tr>
          <td>${item.name}</td>
          <td>₹${item.price}</td>
          <td>
            <input type="number" min="1"
              value="${item.quantity}"
              onchange="updateQuantity(${index}, this.value)">
          </td>
          <td>
            <button onclick="removeItem(${index})">X</button>
          </td>
        </tr>
      `;
    });

    html += `</table>`;
    document.getElementById("cart").innerHTML = html;

    calculateTotal();
  }

  function updateQuantity(index, qty) {
    products[index].quantity = Number(qty);
    renderCart();
  }

  function removeItem(index) {
    products.splice(index, 1);
    renderCart();
  }

  function applyCoupon() {
    const code = document.getElementById("coupon").value;

    if (code === "SAVE10") {
      couponDiscount = 0.10;
      alert("Coupon Applied: 10% OFF");
    } else {
      couponDiscount = 0;
    }

    calculateTotal();
  }

  function calculateTotal() {
    let total = 0;
    let discount = 0;

    products.forEach(item => {
      let itemTotal = item.price * item.quantity;

      if (item.quantity >= 5) {
        discount += itemTotal * 0.10;
      }

      if (item.category === "electronics") {
        discount += itemTotal * 0.05;
      }

      total += itemTotal;
    });

    const hour = new Date().getHours();
    if (hour >= 18 && hour <= 21) {
      discount += total * 0.05;
    }

    discount += total * couponDiscount;

    const finalAmount = total - discount;

    document.getElementById("total").innerText =
      `Total: ₹${finalAmount.toFixed(2)} (You saved ₹${discount.toFixed(2)})`;
  }

  renderCart();
</script>

</body>
</html>
